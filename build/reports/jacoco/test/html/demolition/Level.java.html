<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Level.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Demolition</a> &gt; <a href="index.source.html" class="el_package">demolition</a> &gt; <span class="el_source">Level.java</span></div><h1>Level.java</h1><pre class="source lang-java linenums">package demolition;

import java.util.List;
import java.util.ArrayList;

public class Level {
    private List&lt;Enemy&gt; enemies;
    private List&lt;SolidWall&gt; solidWalls;
    private List&lt;BrokenWall&gt; brokenWalls;
    private List&lt;Bomb&gt; bombs;
    private List&lt;Empty&gt; empty;
    private Goal goal;
    private Player player;
    private List&lt;ExplosionTile&gt; explosionTiles;
    private int timeLeft;
    private int lastDrawn;
    // TODO: Add time left to level object
    
    //Add bombs and explosions later

<span class="fc" id="L21">    public Level(){</span>
<span class="fc" id="L22">        this.enemies = new ArrayList&lt;Enemy&gt;();</span>
<span class="fc" id="L23">        this.solidWalls = new ArrayList&lt;SolidWall&gt;();</span>
<span class="fc" id="L24">        this.brokenWalls = new ArrayList&lt;BrokenWall&gt;();</span>
<span class="fc" id="L25">        this.empty = new ArrayList&lt;Empty&gt;();</span>
<span class="fc" id="L26">        this.bombs = new ArrayList&lt;Bomb&gt;();</span>
<span class="fc" id="L27">        this.explosionTiles = new ArrayList&lt;ExplosionTile&gt;();</span>
<span class="fc" id="L28">    }</span>

    // TODO: Refactor to only add game object and make it so getters handle casting, since everytime you want to add something to the level you will have to add new logic to level.
    public void addObject(GameObject object){
<span class="fc bfc" id="L32" title="All 2 branches covered.">        if (object instanceof Enemy){</span>
<span class="fc" id="L33">            this.enemies.add((Enemy) object);</span>
<span class="fc bfc" id="L34" title="All 2 branches covered.">        } else if (object instanceof SolidWall){</span>
<span class="fc" id="L35">            this.solidWalls.add((SolidWall) object);</span>
<span class="fc bfc" id="L36" title="All 2 branches covered.">        } else if (object instanceof BrokenWall){</span>
<span class="fc" id="L37">            this.brokenWalls.add((BrokenWall) object);</span>
<span class="fc bfc" id="L38" title="All 2 branches covered.">        } else if (object instanceof Empty){</span>
<span class="fc" id="L39">            this.empty.add((Empty) object);</span>
<span class="fc bfc" id="L40" title="All 2 branches covered.">        } else if (object instanceof Goal){</span>
<span class="fc" id="L41">            this.goal = (Goal) object;</span>
<span class="fc bfc" id="L42" title="All 2 branches covered.">        } else if (object instanceof Player){</span>
<span class="fc" id="L43">            this.player = (Player) object;</span>
<span class="fc bfc" id="L44" title="All 2 branches covered.">        } else if (object instanceof Bomb){</span>
<span class="fc" id="L45">            this.bombs.add((Bomb) object);</span>
<span class="pc bpc" id="L46" title="1 of 2 branches missed.">        } else if (object instanceof ExplosionTile){</span>
<span class="fc" id="L47">            this.explosionTiles.add((ExplosionTile) object);</span>
        }
<span class="fc" id="L49">    }</span>

    public void setTimeLeft(int seconds){
<span class="fc" id="L52">        this.timeLeft = seconds;</span>
<span class="fc" id="L53">    }</span>

    public int getTimeLeft(){
<span class="fc" id="L56">        return this.timeLeft;</span>
    }

    // Ensure player does not die after winning if timer lapses out
    public int tick(int millis){
<span class="fc" id="L61">        int oneSecond = 1000;</span>
<span class="fc bfc" id="L62" title="All 2 branches covered.">        if (millis &gt;= this.lastDrawn + oneSecond){</span>
<span class="fc" id="L63">            this.timeLeft -= 1;</span>
<span class="fc" id="L64">            this.lastDrawn = millis;</span>
        }
<span class="fc" id="L66">        return this.timeLeft;</span>
    }

    public GameObject getObjectAt(int x, int y){
<span class="nc" id="L70">        List&lt;GameObject&gt; objects = this.getGameObjects();</span>
<span class="nc bnc" id="L71" title="All 2 branches missed.">        for (GameObject object: objects){</span>
<span class="nc bnc" id="L72" title="All 4 branches missed.">            if (object.xPos == x &amp;&amp; object.yPos == y){</span>
<span class="nc" id="L73">                return object;</span>
            }
<span class="nc" id="L75">        }</span>
<span class="nc" id="L76">        return null;</span>
    }

    public List&lt;Bomb&gt; getBombs(){
<span class="fc" id="L80">        return this.bombs;</span>
    }

    public List&lt;Enemy&gt; getEnemies(){
<span class="fc" id="L84">        return this.enemies;</span>
    }

    public List&lt;SolidWall&gt; getSolidWalls(){
<span class="nc" id="L88">        return this.solidWalls;</span>
    }

    public List &lt;BrokenWall&gt; getBrokenWalls(){
<span class="fc" id="L92">        return this.brokenWalls;</span>
    }
    
    public Player getPlayer(){
<span class="fc" id="L96">        return this.player;</span>
    }

    public List&lt;Empty&gt; getEmpty(){
<span class="nc" id="L100">        return this.empty;</span>
    }
    
    public Goal getGoal(){
<span class="fc" id="L104">        return this.goal;</span>
    }

    public List&lt;ExplosionTile&gt; getExplosionTiles(){
<span class="fc" id="L108">        List&lt;ExplosionTile&gt; explosionTiles = this.explosionTiles;</span>
<span class="fc" id="L109">        List&lt;ExplosionTile&gt; newList = new ArrayList&lt;ExplosionTile&gt;();</span>
<span class="fc bfc" id="L110" title="All 2 branches covered.">        for (ExplosionTile tile: explosionTiles){</span>
<span class="fc bfc" id="L111" title="All 2 branches covered.">            if (!tile.isRemoved){</span>
<span class="fc" id="L112">                newList.add(tile);</span>
            }
<span class="fc" id="L114">        }</span>
<span class="fc" id="L115">        this.explosionTiles = newList;</span>
<span class="fc" id="L116">        return this.explosionTiles;</span>
    }

    // Gets all gameobjects in the order they are to be printed
    public List&lt;GameObject&gt; getGameObjects(){
<span class="fc" id="L121">        List&lt;GameObject&gt; GameObjects = new ArrayList&lt;GameObject&gt;();</span>
<span class="fc" id="L122">        GameObjects.addAll(empty);</span>
<span class="fc" id="L123">        GameObjects.addAll(solidWalls);</span>
<span class="fc" id="L124">        GameObjects.addAll(brokenWalls);</span>
<span class="fc" id="L125">        GameObjects.add(goal);</span>
<span class="fc" id="L126">        GameObjects.addAll(explosionTiles);</span>
<span class="fc" id="L127">        GameObjects.addAll(bombs);</span>
        
<span class="fc" id="L129">        List&lt;GameObject&gt; sorted = new ArrayList&lt;GameObject&gt;();</span>
<span class="fc" id="L130">        sorted.addAll(enemies);</span>
<span class="fc" id="L131">        sorted.add(player);</span>
        
<span class="fc" id="L133">        int minIndex = 0;</span>
<span class="fc" id="L134">        int minY = 1000; </span>
<span class="fc bfc" id="L135" title="All 2 branches covered.">        while (sorted.size() &gt; 0) {</span>
            // Find the object with the smallest y;
<span class="fc bfc" id="L137" title="All 2 branches covered.">            for (int i = 0; i &lt; sorted.size(); i++){</span>
<span class="fc" id="L138">                GameObject current = sorted.get(i);</span>
<span class="fc bfc" id="L139" title="All 2 branches covered.">                if (current.yPos &lt; minY){</span>
<span class="fc" id="L140">                    minY = current.yPos;</span>
<span class="fc" id="L141">                    minIndex = i;</span>
                }
            }
<span class="fc" id="L144">            GameObjects.add(sorted.get(minIndex));</span>
<span class="fc" id="L145">            sorted.remove(minIndex);</span>
<span class="fc" id="L146">            minY = 1000;</span>
        }
        

<span class="fc" id="L150">        return GameObjects;</span>
    }

    public boolean removeAllObjects(){
<span class="nc" id="L154">        List&lt;GameObject&gt; gameObjects = getGameObjects();</span>
<span class="nc bnc" id="L155" title="All 4 branches missed.">        if (gameObjects == null || gameObjects.size() &lt; 0){</span>
<span class="nc" id="L156">            return false;</span>
        }
<span class="nc bnc" id="L158" title="All 2 branches missed.">        for (GameObject object: gameObjects){</span>
<span class="nc" id="L159">            object.isRemoved = true;</span>
<span class="nc" id="L160">        }</span>
<span class="nc" id="L161">        return true;</span>
    }

    public boolean reset(){
<span class="nc" id="L165">        List&lt;Enemy&gt; enemies = this.enemies;</span>
<span class="nc bnc" id="L166" title="All 2 branches missed.">        for(Enemy e: enemies){</span>
<span class="nc" id="L167">            e.isRemoved = false;</span>
<span class="nc" id="L168">            e.xPos = e.xStarting;</span>
<span class="nc" id="L169">            e.yPos = e.yStarting;</span>
<span class="nc" id="L170">        }</span>

<span class="nc" id="L172">        List&lt;BrokenWall&gt; brokenWalls = this.brokenWalls;</span>
<span class="nc bnc" id="L173" title="All 2 branches missed.">        for(BrokenWall w: brokenWalls){</span>
<span class="nc" id="L174">            w.isRemoved = false;</span>
<span class="nc" id="L175">        }</span>

<span class="nc" id="L177">        this.explosionTiles.clear();</span>
<span class="nc" id="L178">        this.bombs.clear();</span>

<span class="nc" id="L180">        player.xPos = player.getXStarting();</span>
<span class="nc" id="L181">        player.yPos = player.getYStarting();</span>
<span class="nc" id="L182">        player.currentAnimation = player.animations.get(Direction.DOWN);</span>
<span class="nc" id="L183">        return true;</span>
    }

}

</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>